"0","rankall <- function(outcome, num = ""best"") {"
"0","  # Read the outcome data"
"0","  data <- read.csv(""ProgrammingAssignment3_Data/outcome-of-care-measures.csv"", colClasses = ""character"")"
"0","  "
"0","  # Define valid outcomes and their corresponding column names in the data"
"0","  valid_outcomes <- c(""heart attack"", ""heart failure"", ""pneumonia"")"
"0","  outcome_column <- c(""heart attack"" = ""Hospital.30.Day.Death..Mortality..Rates.from.Heart.Attack"","
"0","                      ""heart failure"" = ""Hospital.30.Day.Death..Mortality..Rates.from.Heart.Failure"","
"0","                      ""pneumonia"" = ""Hospital.30.Day.Death..Mortality..Rates.from.Pneumonia"")"
"0","  "
"0","  # Check if the provided outcome is valid"
"0","  if (!outcome %in% valid_outcomes) {"
"0","    stop(""invalid outcome"")"
"0","  }"
"0","  "
"0","  # Initialize an empty data frame for the results"
"0","  results <- data.frame(hospital = character(), state = character(), stringsAsFactors = FALSE)"
"0","  "
"0","  # Get the list of states"
"0","  states <- unique(data$State)"
"0","  "
"0","  # Loop over each state to find the hospital of the given rank"
"0","  for (state in states) {"
"0","    # Subset the data for the specified state and outcome"
"0","    state_data <- subset(data, State == state)"
"0","    outcome_data <- state_data[, c(""Hospital.Name"", outcome_column[outcome])]"
"0","    "
"0","    # Convert the outcome data to numeric and remove rows with NA values"
"0","    outcome_data[, 2] <- suppressWarnings(as.numeric(outcome_data[, 2]))"
"0","    outcome_data <- na.omit(outcome_data)"
"0","    "
"0","    # Order the data by outcome and hospital name (to handle ties)"
"0","    outcome_data <- outcome_data[order(outcome_data[, 2], outcome_data[, 1]), ]"
"0","    "
"0","    # Determine the ranking"
"0","    if (num == ""best"") {"
"0","      rank <- 1"
"0","    } else if (num == ""worst"") {"
"0","      rank <- nrow(outcome_data)"
"0","    } else if (is.numeric(as.numeric(num)) && as.numeric(num) > 0 && as.numeric(num) <= nrow(outcome_data)) {"
"0","      rank <- as.numeric(num)"
"0","    } else {"
"0","      rank <- NA"
"0","    }"
"0","    "
"0","    # Get the hospital name with the given rank or NA if the rank is not valid"
"0","    hospital <- if (!is.na(rank) && rank <= nrow(outcome_data)) {"
"0","      outcome_data[rank, ""Hospital.Name""]"
"0","    } else {"
"0","      NA"
"0","    }"
"0","    "
"0","    # Append the result to the results data frame"
"0","    results <- rbind(results, data.frame(hospital = hospital, state = state))"
"0","  }"
"0","  "
"0","  return(results)"
"0","}"
"0",""
"0","# Example usage:"
"0","head(rankall(""heart attack"", 20), 10)"
